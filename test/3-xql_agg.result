CREATE DATABASE IF NOT EXISTS `xql_test`;
USE `xql_test`;
DROP TABLE IF EXISTS `state`;
Warnings:
Note	1051	Unknown table 'state'
CREATE TABLE `state` (`code` varchar(2) NOT NULL, `country_code` varchar(2) NOT NULL, `description` varchar(255) NOT NULL, PRIMARY KEY  (`code`)) ENGINE=MyISAM DEFAULT CHARSET=latin1;
INSERT INTO `state` VALUES ('al','us','Alabama'),('ak','us','Alaska'),('as','us','American Samoa'),('az','us','Arizona'),('ar','us','Arkansas'),('ca','us','California'),('co','us','Colorado'),('ct','us','Connecticut'),('de','us','Delaware'),('dc','us','District of Columbia'),('fm','us','Federated States of Micronesia'),('fl','us','Florida'),('ga','us','Georgia'),('gu','us','Guam'),('hi','us','Hawaii'),('id','us','Idaho'),('il','us','Illinois'),('in','us','Indiana'),('ia','us','Iowa'),('ks','us','Kansas'),('ky','us','Kentucky'),('la','us','Louisiana'),('me','us','Maine'),('mh','us','Marshall Islands'),('md','us','Maryland'),('ma','us','Massachusetts'),('mi','us','Michigan'),('mn','us','Minnesota'),('ms','us','Mississippi'),('mo','us','Missouri'),('mt','us','Montana'),('ne','us','Nebraska'),('nv','us','Nevada'),('nh','us','New Hampshire'),('nj','us','New Jersey'),('nm','us','New Mexico'),('ny','us','New York'),('nc','us','North Carolina'),('nd','us','North Dakota'),('mp','us','Northern Mariana Islands'),('oh','us','Ohio'),('ok','us','Oklahoma'),('or','us','Oregon'),('pw','us','Palau'),('pa','us','Pennsylvania'),('pr','us','Puerto Rico'),('ri','us','Rhode Island'),('sc','us','South Carolina'),('sd','us','South Dakota'),('tn','us','Tennessee'),('tx','us','Texas'),('ut','us','Utah'),('vt','us','Vermont'),('vi','us','Virgin Island'),('va','us','Virginia'),('wa','us','Washington'),('wv','us','West Virginia'),('wi','us','Wisconsin'),('wy','us','Wyoming'),('ab','ca','Alberta'),('bc','ca','British Columbia'),('mb','ca','Manitoba'),('nb','ca','New Brunswick'),('nf','ca','New Foundland'),('nt','ca','Northwest Territories'),('ns','ca','Nova Scotia'),('on','ca','Ontario'),('pe','ca','Prince Edward Island'),('pq','ca','Quebec'),('sk','ca','Saskatchewan'),('yt','ca','Yukon Territories');
DROP TABLE IF EXISTS `country`;
Warnings:
Note	1051	Unknown table 'country'
CREATE TABLE `country` (`code` varchar(2) NOT NULL, `description` varchar(255) NOT NULL, PRIMARY KEY  (`code`)) ENGINE=MyISAM DEFAULT CHARSET=latin1;
INSERT INTO `country` VALUES ('us','USA'),('ca','Canada'),('nl','Netherlands');
SELECT xql_agg("states" AS `xql:root`, code AS `state`) FROM `state`;
xql_agg("states" AS `xql:root`, code AS `state`)
<states><state>ab</state><state>ak</state><state>al</state><state>ar</state><state>as</state><state>az</state><state>bc</state><state>ca</state><state>co</state><state>ct</state><state>dc</state><state>de</state><state>fl</state><state>fm</state><state>ga</state><state>gu</state><state>hi</state><state>ia</state><state>id</state><state>il</state><state>in</state><state>ks</state><state>ky</state><state>la</state><state>ma</state><state>mb</state><state>md</state><state>me</state><state>mh</state><state>mi</state><state>mn</state><state>mo</state><state>mp</state><state>ms</state><state>mt</state><state>nb</state><state>nc</state><state>nd</state><state>ne</state><state>nf</state><state>nh</state><state>nj</state><state>nm</state><state>ns</state><state>nt</state><state>nv</state><state>ny</state><state>oh</state><state>ok</state><state>on</state><state>or</state><state>pa</state><state>pe</state><state>pq</state><state>pr</state><state>pw</state><state>ri</state><state>sc</state><state>sd</state><state>sk</state><state>tn</state><state>tx</state><state>ut</state><state>va</state><state>vi</state><state>vt</state><state>wa</state><state>wi</state><state>wv</state><state>wy</state><state>yt</state></states>
SELECT xql_agg("states" AS `xql:root`, code AS ``) FROM `state`;
xql_agg("states" AS `xql:root`, code AS ``)
<states><ab/><ak/><al/><ar/><as/><az/><bc/><ca/><co/><ct/><dc/><de/><fl/><fm/><ga/><gu/><hi/><ia/><id/><il/><in/><ks/><ky/><la/><ma/><mb/><md/><me/><mh/><mi/><mn/><mo/><mp/><ms/><mt/><nb/><nc/><nd/><ne/><nf/><nh/><nj/><nm/><ns/><nt/><nv/><ny/><oh/><ok/><on/><or/><pa/><pe/><pq/><pr/><pw/><ri/><sc/><sd/><sk/><tn/><tx/><ut/><va/><vi/><vt/><wa/><wi/><wv/><wy/><yt/></states>
SELECT xql_agg("states" AS `xql:root`, "state" AS `xql:child`, code, `country_code`, `state`.`description`) FROM `state` WHERE country_code='ca';
xql_agg("states" AS `xql:root`, "state" AS `xql:child`, code, `country_code`, `state`.`description`)
<states><state><code>ab</code><country_code>ca</country_code><description>Alberta</description></state><state><code>bc</code><country_code>ca</country_code><description>British Columbia</description></state><state><code>mb</code><country_code>ca</country_code><description>Manitoba</description></state><state><code>nb</code><country_code>ca</country_code><description>New Brunswick</description></state><state><code>nf</code><country_code>ca</country_code><description>New Foundland</description></state><state><code>nt</code><country_code>ca</country_code><description>Northwest Territories</description></state><state><code>ns</code><country_code>ca</country_code><description>Nova Scotia</description></state><state><code>on</code><country_code>ca</country_code><description>Ontario</description></state><state><code>pe</code><country_code>ca</country_code><description>Prince Edward Island</description></state><state><code>pq</code><country_code>ca</country_code><description>Quebec</description></state><state><code>sk</code><country_code>ca</country_code><description>Saskatchewan</description></state><state><code>yt</code><country_code>ca</country_code><description>Yukon Territories</description></state></states>
SELECT xql_agg("states" AS `xql:root`, "state" AS `xql:child`, code, country_code AS `country`, description) FROM `state` WHERE country_code='ca';
xql_agg("states" AS `xql:root`, "state" AS `xql:child`, code, country_code AS `country`, description)
<states><state><code>ab</code><country>ca</country><description>Alberta</description></state><state><code>bc</code><country>ca</country><description>British Columbia</description></state><state><code>mb</code><country>ca</country><description>Manitoba</description></state><state><code>nb</code><country>ca</country><description>New Brunswick</description></state><state><code>nf</code><country>ca</country><description>New Foundland</description></state><state><code>nt</code><country>ca</country><description>Northwest Territories</description></state><state><code>ns</code><country>ca</country><description>Nova Scotia</description></state><state><code>on</code><country>ca</country><description>Ontario</description></state><state><code>pe</code><country>ca</country><description>Prince Edward Island</description></state><state><code>pq</code><country>ca</country><description>Quebec</description></state><state><code>sk</code><country>ca</country><description>Saskatchewan</description></state><state><code>yt</code><country>ca</country><description>Yukon Territories</description></state></states>
SELECT xql_agg("states" AS `xql:root`, "state" AS `xql:child`, code, country_code AS `country`, description) FROM `state` WHERE FALSE;
xql_agg("states" AS `xql:root`, "state" AS `xql:child`, code, country_code AS `country`, description)
NULL
SELECT xql_agg("states" AS `xql:root`, xql_forest("state" AS `xql:root`, code, country_code AS `country`, description)) FROM `state`  WHERE country_code='ca';
xql_agg("states" AS `xql:root`, xql_forest("state" AS `xql:root`, code, country_code AS `country`, description))
<states><state><code>ab</code><country>ca</country><description>Alberta</description></state><state><code>bc</code><country>ca</country><description>British Columbia</description></state><state><code>mb</code><country>ca</country><description>Manitoba</description></state><state><code>nb</code><country>ca</country><description>New Brunswick</description></state><state><code>nf</code><country>ca</country><description>New Foundland</description></state><state><code>nt</code><country>ca</country><description>Northwest Territories</description></state><state><code>ns</code><country>ca</country><description>Nova Scotia</description></state><state><code>on</code><country>ca</country><description>Ontario</description></state><state><code>pe</code><country>ca</country><description>Prince Edward Island</description></state><state><code>pq</code><country>ca</country><description>Quebec</description></state><state><code>sk</code><country>ca</country><description>Saskatchewan</description></state><state><code>yt</code><country>ca</country><description>Yukon Territories</description></state></states>
SELECT xql_agg("states" AS `xql:root`, xql_element("state", NULL, code, country_code AS `country`, description)) FROM `state` WHERE country_code='ca';
xql_agg("states" AS `xql:root`, xql_element("state", NULL, code, country_code AS `country`, description))
<states><state code="ab" country="ca" description="Alberta"/><state code="bc" country="ca" description="British Columbia"/><state code="mb" country="ca" description="Manitoba"/><state code="nb" country="ca" description="New Brunswick"/><state code="nf" country="ca" description="New Foundland"/><state code="nt" country="ca" description="Northwest Territories"/><state code="ns" country="ca" description="Nova Scotia"/><state code="on" country="ca" description="Ontario"/><state code="pe" country="ca" description="Prince Edward Island"/><state code="pq" country="ca" description="Quebec"/><state code="sk" country="ca" description="Saskatchewan"/><state code="yt" country="ca" description="Yukon Territories"/></states>
SELECT xql_agg("states" AS `xql:root`, "state" AS `xql:child`, code, description) FROM `state` GROUP BY country_code;
xql_agg("states" AS `xql:root`, "state" AS `xql:child`, code, description)
<states><state><code>ab</code><description>Alberta</description></state><state><code>bc</code><description>British Columbia</description></state><state><code>mb</code><description>Manitoba</description></state><state><code>nb</code><description>New Brunswick</description></state><state><code>nf</code><description>New Foundland</description></state><state><code>nt</code><description>Northwest Territories</description></state><state><code>ns</code><description>Nova Scotia</description></state><state><code>sk</code><description>Saskatchewan</description></state><state><code>pq</code><description>Quebec</description></state><state><code>pe</code><description>Prince Edward Island</description></state><state><code>on</code><description>Ontario</description></state><state><code>yt</code><description>Yukon Territories</description></state></states>
<states><state><code>ri</code><description>Rhode Island</description></state><state><code>pr</code><description>Puerto Rico</description></state><state><code>pa</code><description>Pennsylvania</description></state><state><code>pw</code><description>Palau</description></state><state><code>or</code><description>Oregon</description></state><state><code>ok</code><description>Oklahoma</description></state><state><code>oh</code><description>Ohio</description></state><state><code>mp</code><description>Northern Mariana Islands</description></state><state><code>nd</code><description>North Dakota</description></state><state><code>va</code><description>Virginia</description></state><state><code>nc</code><description>North Carolina</description></state><state><code>sc</code><description>South Carolina</description></state><state><code>sd</code><description>South Dakota</description></state><state><code>de</code><description>Delaware</description></state><state><code>wy</code><description>Wyoming</description></state><state><code>wi</code><description>Wisconsin</description></state><state><code>wv</code><description>West Virginia</description></state><state><code>wa</code><description>Washington</description></state><state><code>vi</code><description>Virgin Island</description></state><state><code>vt</code><description>Vermont</description></state><state><code>ut</code><description>Utah</description></state><state><code>tx</code><description>Texas</description></state><state><code>tn</code><description>Tennessee</description></state><state><code>ny</code><description>New York</description></state><state><code>nm</code><description>New Mexico</description></state><state><code>il</code><description>Illinois</description></state><state><code>id</code><description>Idaho</description></state><state><code>hi</code><description>Hawaii</description></state><state><code>gu</code><description>Guam</description></state><state><code>ga</code><description>Georgia</description></state><state><code>fl</code><description>Florida</description></state><state><code>fm</code><description>Federated States of Micronesia</description></state><state><code>dc</code><description>District of Columbia</description></state><state><code>ct</code><description>Connecticut</description></state><state><code>co</code><description>Colorado</description></state><state><code>ca</code><description>California</description></state><state><code>ar</code><description>Arkansas</description></state><state><code>az</code><description>Arizona</description></state><state><code>as</code><description>American Samoa</description></state><state><code>ak</code><description>Alaska</description></state><state><code>in</code><description>Indiana</description></state><state><code>ia</code><description>Iowa</description></state><state><code>ks</code><description>Kansas</description></state><state><code>nj</code><description>New Jersey</description></state><state><code>nh</code><description>New Hampshire</description></state><state><code>nv</code><description>Nevada</description></state><state><code>ne</code><description>Nebraska</description></state><state><code>mt</code><description>Montana</description></state><state><code>mo</code><description>Missouri</description></state><state><code>ms</code><description>Mississippi</description></state><state><code>mn</code><description>Minnesota</description></state><state><code>mi</code><description>Michigan</description></state><state><code>ma</code><description>Massachusetts</description></state><state><code>md</code><description>Maryland</description></state><state><code>mh</code><description>Marshall Islands</description></state><state><code>me</code><description>Maine</description></state><state><code>la</code><description>Louisiana</description></state><state><code>ky</code><description>Kentucky</description></state><state><code>al</code><description>Alabama</description></state></states>
SELECT xql_element("states", xql_agg("state" AS `xql:child`, state.code, state.description), country_code AS `code`) FROM `state` GROUP BY country_code;
xql_element("states", xql_agg("state" AS `xql:child`, state.code, state.description), country_code AS `code`)
<states code="ca"><state><code>ab</code><description>Alberta</description></state><state><code>bc</code><description>British Columbia</description></state><state><code>mb</code><description>Manitoba</description></state><state><code>nb</code><description>New Brunswick</description></state><state><code>nf</code><description>New Foundland</description></state><state><code>nt</code><description>Northwest Territories</description></state><state><code>ns</code><description>Nova Scotia</description></state><state><code>sk</code><description>Saskatchewan</description></state><state><code>pq</code><description>Quebec</description></state><state><code>pe</code><description>Prince Edward Island</description></state><state><code>on</code><description>Ontario</description></state><state><code>yt</code><description>Yukon Territories</description></state></states>
<states code="us"><state><code>ri</code><description>Rhode Island</description></state><state><code>pr</code><description>Puerto Rico</description></state><state><code>pa</code><description>Pennsylvania</description></state><state><code>pw</code><description>Palau</description></state><state><code>or</code><description>Oregon</description></state><state><code>ok</code><description>Oklahoma</description></state><state><code>oh</code><description>Ohio</description></state><state><code>mp</code><description>Northern Mariana Islands</description></state><state><code>nd</code><description>North Dakota</description></state><state><code>va</code><description>Virginia</description></state><state><code>nc</code><description>North Carolina</description></state><state><code>sc</code><description>South Carolina</description></state><state><code>sd</code><description>South Dakota</description></state><state><code>de</code><description>Delaware</description></state><state><code>wy</code><description>Wyoming</description></state><state><code>wi</code><description>Wisconsin</description></state><state><code>wv</code><description>West Virginia</description></state><state><code>wa</code><description>Washington</description></state><state><code>vi</code><description>Virgin Island</description></state><state><code>vt</code><description>Vermont</description></state><state><code>ut</code><description>Utah</description></state><state><code>tx</code><description>Texas</description></state><state><code>tn</code><description>Tennessee</description></state><state><code>ny</code><description>New York</description></state><state><code>nm</code><description>New Mexico</description></state><state><code>il</code><description>Illinois</description></state><state><code>id</code><description>Idaho</description></state><state><code>hi</code><description>Hawaii</description></state><state><code>gu</code><description>Guam</description></state><state><code>ga</code><description>Georgia</description></state><state><code>fl</code><description>Florida</description></state><state><code>fm</code><description>Federated States of Micronesia</description></state><state><code>dc</code><description>District of Columbia</description></state><state><code>ct</code><description>Connecticut</description></state><state><code>co</code><description>Colorado</description></state><state><code>ca</code><description>California</description></state><state><code>ar</code><description>Arkansas</description></state><state><code>az</code><description>Arizona</description></state><state><code>as</code><description>American Samoa</description></state><state><code>ak</code><description>Alaska</description></state><state><code>in</code><description>Indiana</description></state><state><code>ia</code><description>Iowa</description></state><state><code>ks</code><description>Kansas</description></state><state><code>nj</code><description>New Jersey</description></state><state><code>nh</code><description>New Hampshire</description></state><state><code>nv</code><description>Nevada</description></state><state><code>ne</code><description>Nebraska</description></state><state><code>mt</code><description>Montana</description></state><state><code>mo</code><description>Missouri</description></state><state><code>ms</code><description>Mississippi</description></state><state><code>mn</code><description>Minnesota</description></state><state><code>mi</code><description>Michigan</description></state><state><code>ma</code><description>Massachusetts</description></state><state><code>md</code><description>Maryland</description></state><state><code>mh</code><description>Marshall Islands</description></state><state><code>me</code><description>Maine</description></state><state><code>la</code><description>Louisiana</description></state><state><code>ky</code><description>Kentucky</description></state><state><code>al</code><description>Alabama</description></state></states>
DROP DATABASE IF EXISTS `xql_test`;
